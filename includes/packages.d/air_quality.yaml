sensor:
  # Office Air Quality
  - platform: template
    sensors:
      aq_office_co2a:
        friendly_name: "Office CO2a"
        unit_of_measurement: 'ppm'
        value_template: "{{ state_attr('air_quality.mi_air_monitor_2', 'carbon_dioxide_equivalent') }}"
        icon_template: mdi:molecule-co2
      aq_office_tvoc:
        friendly_name: "Office TVOC"
        unit_of_measurement: 'mg/m3'
        value_template: "{{ state_attr('air_quality.mi_air_monitor_2', 'total_volatile_organic_compounds') }}"
        icon_template: mdi:scatter-plot
      aq_office_temperature:
        friendly_name: "Office Temperature 3"
        device_class: temperature
        unit_of_measurement: '°C'
        value_template: "{{ state_attr('air_quality.mi_air_monitor_2', 'temperature') }}"
      aq_office_humidity:
        friendly_name: "Office Humidity 3"
        device_class: temperature
        unit_of_measurement: '%'
        value_template: "{{ state_attr('air_quality.mi_air_monitor_2', 'humidity') }}"

  # REST sensor for Air Pollution Monitor
  - platform: rest
    name: "AirPM Rest Data"
    resource: !secret air_pollution_url
    scan_interval: 120
    value_template: "no state"
    json_attributes_path: '$.[0]'
    json_attributes:
      - 'aqi'
      - 'dust_1_0'
      - 'dust_2_5'
      - 'dust_10_0'
      - temperature
      - humidity
      - fw
      - ts

  # Outside Air Pollution Monitor (APM) sensors based on the REST above
  - platform: template
    sensors:
      apm_aqi:
        friendly_name: 'Outside Air Quality'
        value_template: "{{ state_attr('sensor.airpm_rest_data', 'aqi') }}"
        unit_of_measurement: 'AQI'
        icon_template: mdi:smog
      apm_pm1_0:
        friendly_name: 'Outside PM 1.0'
        value_template: "{{ state_attr('sensor.airpm_rest_data', 'dust_1_0') }}"
        unit_of_measurement: 'μg/m3'
        icon_template: mdi:numeric-1-circle-outline
      apm_pm2_5:
        friendly_name: 'Outside PM 2.5'
        value_template: "{{ state_attr('sensor.airpm_rest_data', 'dust_2_5') }}"
        unit_of_measurement: 'μg/m3'
        icon_template: mdi:numeric-2-circle-outline
      apm_pm10:
        friendly_name: 'Outside PM 10'
        value_template: "{{ state_attr('sensor.airpm_rest_data', 'dust_10_0') }}"
        unit_of_measurement: 'μg/m3'
        icon_template: mdi:numeric-10-circle-outline
      apm_temperature:
        friendly_name: 'Outside Temperature'
        value_template: "{{ state_attr('sensor.airpm_rest_data', 'temperature')|round(1) }}"
        device_class: temperature
        unit_of_measurement: '°C'
      apm_humidity:
        friendly_name: 'Outside Humidity'
        value_template: "{{ state_attr('sensor.airpm_rest_data', 'humidity')|round(1) }}"
        device_class: humidity
        unit_of_measurement: '%'
